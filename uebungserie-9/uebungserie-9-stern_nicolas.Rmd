---
title: "Uebungserie 9"
author: "Nicolas Stern"
date: "16.12.2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE}
library(TeachingDemos)
```

```{r echo=FALSE}
rm(list = ls())
setwd("C:/ieu/workspace/R/descriptive-statistik/uebungen/uebungserie-9")
```

# Aufgabe: Linksseitiger Test bei $\mu$, $\sigma$ bekannt

- Aufgabe: Die Datei „lightbulbs.txt“ enthält eine neue Stichprobe des Glühbirnenherstellers. Laden Sie die Datei mit dem Befehl scan. Lässt sich aufgrund dieser Stichprobe die Behauptung des Herstellers, dass die Glühbirnen eine Mindestlebensdauer von 10'000 Stunden besitzen, bei einem Signifikanzniveau von 1% verwerfen? Die Standardabweichung beträgt 120 Stunden.

- Hypothese:

    H$_{0}$ :  $\mu$ >= 10'000 Stunden

    H$_{a}$ :  $\mu$ < 10'000 Stunden

- Evaluation von H$_{0}$ durch Berechung der Test-Wert (Z-Wert)

```{r}
lightbulbs <- scan(file = "lightbulbs.txt")
sigma <- 120 # Standardabweichung der Population
mu <- 10000  # Populationsmittelwert
n <- length(lightbulbs) # Stichprobengrösse
alpha <- 0.01 # Signifikanzniveau

xbar <- mean(lightbulbs) # Stichprobenmittlewert

# Test-Wert : 
z.value <- (xbar - mu)/ (sigma /sqrt(n))
z.value

# Kritischer Wert:
z.alpha <- qnorm(alpha)

# Ist der Test-Wert > kritischer Wert, dann gibt es keine starke Evidenz gegen H0
z.value > z.alpha

```

Test-Wert : `r round(z.value, 4)`

Kritischer Wert : `r round(z.alpha, 4)`
 
Test-Wert ist kleiner als der kritischen Wert. Schlussfolgerung : H$_{0}$  wird verworfen

- Prüfung von  H$_{0}$ durch Vergleich der P-Wert gegen Signifikanzniveau:

```{r}
p.value <- pnorm(z.value) # P-Wert
p.value

# Ist der P-Wert > Signifikanzniveau, dann gibt es keine starke Evidenz gegen H0
p.value > alpha 
```

P-Wert ist kleiner als Signifikanzniveau. Schlussfolgerung : H$_{0}$  wird verworfen

```{r echo=FALSE}
rm(list = ls())
setwd("C:/ieu/workspace/R/descriptive-statistik/uebungen/uebungserie-9")
```

# Aufgabe: Rechtsseitiger Test bei $\mu$, $\sigma$ bekannt

- Aufgabe: Die Datei "cookies.txt" enthält eine neue Stichprobe des Keksherstellers. Laden Sie die Datei mit dem Befehl scan. Lässt sich aufgrund dieser Stichprobe die Behauptung des Herstellers, dass die Kekse einen maximalen Anteil von 2 g enthalten, bei einem Signifikanzniveau von 10% verwerfen? Die Standardabweichung beträgt 0:25 g.

- Hypothese:

    - H$_{0}$ :  $\mu$ <= 2 g

    - H$_{a}$ :  $\mu$ > 2 g

- Evaluation von H$_{0}$ durch Berechung der Test-Wert (Z-Wert)

```{r}
cookies <- scan(file = "cookies.txt")
xbar <-  mean(cookies) # Stichproben Mittlewert
mu <- 2.0 # Populationsmittelwert
sigma <- 0.25 # Standardabweichung der Population
n <- length(cookies) # Stichprobengroesse
alpha <- 0.1 # Signifikanzniveau

# Test-Wert : 
z.value <- (xbar - mu)/ (sigma /sqrt(n))
z.value

# Kritischer Wert:
z.alpha <- qnorm(1-alpha)

# Ist der Test-Wert > kritischer Wert, dann wird H0 verworfen
z.value > z.alpha
```

Test-Wert : `r round(z.value, 4)`

Kritischer Wert : `r round(z.alpha, 4)`

Test-Wert ist kleiner als kritischer Wert. Schlussfolgerung: wir haben keine starke Evidenz gegen H$_{0}$. H$_{0}$ wird nicht verworfen.

- Überprüfung von  H$_{0}$ durch Vergleich des P-Wertes und der Signifikanzniveau:

```{r}
p.value <- pnorm(z.value, lower.tail=FALSE) # p-Wert
p.value

# Ist der P-Wert > Signifikanzniveau, dann gibt es keine starke Evidenz gegen H0
p.value > alpha 

```
P-Wert > Signifikanzniveau. Schlussfolgerung:  wir haben keinen Hinweis, der uns erlaubt, die Nullhpothese zu verwerfen.  H$_{0}$ wird behalten.

```{r echo=FALSE}
rm(list = ls())
setwd("C:/ieu/workspace/R/descriptive-statistik/uebungen/uebungserie-9")
```

# Aufgabe: Zweiseitiger Test bei  $\mu$, $\sigma$ bekannt

- Aufgabe: Die Datei "penguins.txt" enthält eine neue Zufallsstichprobe einer Pinguinkolonie. Laden Sie die Datei mit dem Befehl scan. Das durchschnittliche Gewicht von antarktischen Königspinguinen diesern Kolonie betrug im letzten Jahr 15.4 kg. Lässt sich aufgrund dieser Stichprobe die Behauptung, dass sich das Durchschnittsgewicht der Pinguine nicht verändert hat, bei einem Signifikanzniveau von 5% verwerfen? Die Standardabweichung beträgt 2.5 kg

- Hypothesen:

    - h0 : mu = 15.4 

    - ha : mu != 15.4

- Evaluation von H$_{0}$ durch Berechung der Test-Wert (Z-Wert)

```{r}
penguins <- scan( file = "penguins.txt")
xbar <- mean(penguins) # Stichprobenmittelwert
mu <- 15.4 # Populationmittelwert
sigma <- 2.5 # Standardabweichung der Population
n <- length(penguins)
alpha <- 0.05

# Berechung des Test-Werts
z <-  (xbar-mu)/(sigma/sqrt(n))
z

# Berechung der kritischen Werten
z.alpha.high <- qnorm(1-alpha/2)
z.alpha.high
z.alpha.low <- -z.alpha.high
z.alpha.low

# Ist der Test-Wert zwischen beidn kritischen Werte, dann wird H0 behalten
z < z.alpha.high && z > z.alpha.low
```
Test-Wert liegt zwischen beiden kritischen Werte. Schlussfolgerung : H0 wird behalten

- Prüfung von  H$_{0}$ durch Vergleich des P-Wertes mit dem Signifikanzniveau :
```{r}
p.value = 2 * pnorm(z)
p.value

# Ist der P-Wert > Signifikanzniveau, dann gibt es keine starke Evidenz gegen H0
p.value > alpha 
```
P-Wert ist grösser als Signifikanzniveau. Schlussfolgerung : H0 wird nicht verworfen.

```{r echo=FALSE}
rm(list = ls())
setwd("C:/ieu/workspace/R/descriptive-statistik/uebungen/uebungserie-9")
```
# Aufgabe: Linksseitiger Test bei $\mu$, $\sigma$ unbekannt

- Aufgabe: Die Datei „lightbulbs.txt“ enthält eine neue Stichprobe des Glühbirnenherstellers. Laden Sie die Datei mit dem Befehl scan. Lässt sich aufgrund dieser Stichprobe die Behauptung des Herstellers, dass die Glühbirnen eine Mindestlebensdauer von 10000 Stunden besitzen, bei einem Signifikanzniveau von 1% verwerfen?

- Hypothesen:

    H$_{0}$ :  $\mu$ >= 10000

    H$_{a}$ :  $\mu$ < 10000

```{r}
lightbulbs <- scan(file = "lightbulbs.txt")

alpha <- 0.01 # Signifikanzniveau
mu <- 10000 # Hypothetischer population - Mittelwert
n <- length(lightbulbs) # Stichprobengrösse
xbar <- mean(lightbulbs) # Mittlewert in der Stichproben
s <- sd(lightbulbs)  # Standardabweichung in der Stichproben

# Berechung der Test-Wert
t <- (xbar - mu) / (s / sqrt(n))
t

# Berechnung der kritischen Wert
t.alpha <- qt(p=alpha, df=n-1)
t.alpha # kritischer Wert

# Ist der Test-Wert > kritischer Wert, dann gibt es keine starke Evidenz gegen H0
t > t.alpha 
```
Schlussfolgerung : H$_{0}$  wird verworfen

Hypothese Prüfung mit Vergleich der P-Wert gegen Signifikanzniveau:

```{r}
p.val <- pt(t, df=n-1) # P-Wert
p.val

# Ist der P-Wert > Signifikanzniveau, dann gibt es keine starke Evidenz gegen H0
p.val > alpha 
```
Schlussfolgerung : H$_{0}$  wird verworfen

```{r echo=FALSE}
rm(list = ls())
setwd("C:/ieu/workspace/R/descriptive-statistik/uebungen/uebungserie-9")
```

# Aufgabe: Rechtsseitiger Test bei $\mu$, $\sigma$ unbekannt

- Aufgabe: Die Datei „cookies.txt“ enthält eine neue Stichprobe des Keksherstellers. Laden Sie die Datei mit dem Befehl scan. Lässt sich aufgrund dieser Stichprobe die Behauptung des Herstellers, dass die Kekse einen maximalen Anteil von 2 g enthalten, bei einem Signifikanzniveau von 10% verwerfen

- Hypothesen:

    H$_{0}$ :  $\mu$ <= 2

    H$_{a}$ :  $\mu$ > 2

```{r}
cookies <- scan(file = "cookies.txt")

alpha <- 0.1 # signifikanzniveau
mu <- 2 # Hypothetischer population - Mittelwert
n <- length(cookies) # Stichprobengrösse
xbar <- mean(cookies) # Stichprobenmittelwert
s <- sd(cookies) # Standardabweichung der Stichprobe

# Berechung der Test-Wert
t <- (xbar - mu) / (s / sqrt(n))
t

# Berechnung der kritischen Wert
t.alpha <- qt(p=1-alpha, df=n-1)
t.alpha # kritischer Wert

# Ist der Test-Wert > kritischer Wert, dann wird H0 verworfen
t > t.alpha 
```

Schlussfolgerung : es gibt keine starke Evidenz gegen H0

Hypothese Prüfung mit Vergleich der P-Wert gegen Signifikanzniveau:

```{r}
p.val <- pt(t, df=n-1) # P-Wert
p.val

# Ist der P-Wert > Signifikanzniveau, dann gibt es keine starke Evidenz gegen H0
p.val > alpha 
```

Schlussfolgerung : es gibt keine starke Evidenz gegen H$_{0}$

```{r echo=FALSE}
rm(list = ls())
setwd("C:/ieu/workspace/R/descriptive-statistik/uebungen/uebungserie-9")
```
# Aufgabe: Zweiseitiger Test bei mu, sigma unbekannt

- Aufgabe: Die Datei „penguins.txt“ enthält eine neue Zufallsstichprobe einer Pinguinkolonie. Laden Sie die Datei mit dem Befehl scan. Lässt sich aufgrund dieser Stichprobe die Behauptung, dass sich das Durchschnittsgewicht der Pinguine nicht verändert hat, bei einem Signifikanzniveau von 5% verwerfen?

- Hypothesen: 

    H$_{0}$ : mu = 15.4

    H$_{a}$ : mu != 15.4

```{r}
penguins <- scan(file = "penguins.txt")

alpha <- 0.05 # Signifikanzniveaz
mu <- 15.4 # Durchnittsgewicht aus der Vorjahr
n <- length(penguins) 
xbar <- mean(penguins)
s <- sd(penguins) 

# Berechnung der kritischen Wert
t <- (xbar - mu) / (s / sqrt(n))
t

# Berechnung der kritischen Wert
t.alpha.low <- qt(p=alpha/2, df=n-1)
t.alpha.low
t.alpha.high <- qt(p=1-alpha/2, df=n-1)
t.alpha.high

# Ist der Test-Wert zwischen beiden kritischen Werten, dann gibt es keine starke Evidenz gegen h0
t > t.alpha.low  && t < t.alpha.high
```

Schlussfolgerung : es gibt keine starke Evidenz gegen H0


Hypothese Prüfung mit Vergleich der P-Wert gegen Signifikanzniveau:

```{r}
p.val <- pt(t, df=n-1)*2 # P-Wert
p.val

# Ist der P-Wert > Signifikanzniveau, dann gibt es keine starke Evidenz gegen H0
p.val > alpha 
```

Schlussfolgerung : es gibt keine starke Evidenz gegen H$_{0}$

# TODO

## Aufgabe: Linksseitiger Test des Populationsanteils p

- Aufgabe: Die Datei „grocerystore.csv“ enthält eine Zufallsstichprobe von Kunden einer Metzgerei. Neben dem Geschlecht der Kunden wurde auch deren Verweilzeit im Laden notiert. Importieren Sie die Datei mit dem Befehl read.csv. Lässt sich aufgrund dieser Stichprobe die Behauptung, dass die Metzgerei mehrheitlich von Frauen besucht wird, bei einem Signifikanzniveau von <<<<5% verwerfen? 

- Hypothesen: 

    - h0 : Anteil Frauen > 0.5

    - ha : Anteil Frauen <= 0.5

```{r}
grocery <- read.csv(file="grocerystore.csv", header = T, sep=";" )

n <- nrow(grocery)
n.frauen <- nrow(grocery[grocery$gender == "F", ])

test <- prop.test(n.frauen, n, alternative = "less", correct = FALSE)

result <- test$p.value < alpha

```
P-Wert > Signifikankzniveau : `r result` . H0 wird nicht verworfen

# TODO

# Aufgabe: Rechtsseitiger Test des Populationsanteils p

# TODO

# Aufgabe: Zweiseitiger Test des Populationsanteils p

